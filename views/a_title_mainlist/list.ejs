<%- include('../parts/html-head') %>
<style>
    .row {

        margin: auto;
    }

    body {
        background-color: #EFF0F0;
        display: grid;
    }

    h3 {
        margin: auto;
        margin-top: 40px;
        margin-bottom: 20px;
    }


    table.table tr th {
        background-color: #5F6B6B !Important;

        color: white !Important;

    }

    .my-trash-i {
        color: #5F6B6B;
        cursor: pointer;
    }

    .my-edit-i {
        color: #C77334;
        cursor: pointer;
    }


    .form-group input {
        width: 400px;
    }

    .form-group textarea {
        width: 400px;
    }

    .redstars {
        color: red;
    }

    .pagination>li>a {
        background-color: white;
        color: darkgray;
    }

    .pagination>li>a:focus,
    .pagination>li>a:hover,
    .pagination>li>span:focus,
    .pagination>li>span:hover {
        color: #5a5a5a;
        background-color: #eee;
        border-color: #ddd;
    }

    .pagination>.active>a {
        color: white;
        background-color: #C77334 !Important;
        border: solid 1px #ddd !Important;
    }

    .pagination>.active>a:hover {
        background-color: #C77334 !Important;
        border: solid 1px #5A4181;
    }

    /* .choose {
        margin: 10px 0px 10px 0px !Important;
        border-radius: 0px;

    } */

    .wrap {
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
        width: 150px;
    }

        .wrap02 {
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
        width: 150px;
    }

            .wrap03 {
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
        width: 250px;
    }

    .wrap img {
        width: 100%;
        height: 150px;
        object-fit: cover
    }
</style>

<div class="container ">

    <div class="row justify-content-center">
        <h3>文章列表</h3>
    </div>

    <div class="row justify-content-end">
        <div class="col">
            <a href="/a_title_mainlist/list" class="btn btn-light choose"><i class="fas fa-list"></i></a>
            <a href="/a_title_mainlist/add " class="btn btn-light choose"><i class="fas fa-th"></i></a>
        </div>

         <div class="col">
            <nav aria-label="Page navigation example">
                <ul class="pagination">
                    <li class="page-item <%= page===1 ? 'disabled' : '' %>">
                        <a class="page-link" href="?page=1">
                            <i class="fas fa-angle-double-left"></i>
                        </a>
                    </li>

                    <li class="page-item <%= page===1 ? 'disabled' : '' %>">
                        <a class="page-link" href="?page=<%= page-1 %>">
                            <i class="fas fa-angle-left"></i>
                        </a>
                    </li>

                    <% for(let i=beginPage; i<=endPage; i++){ %>
                    <li class="page-item <%= i===page ? 'active' : '' %>">
                        <a class="page-link" href="?page=<%= i %>"><%= i %></a>
                    </li>
                    <% } %>

                    <li class="page-item <%= page===totalPages ? 'disabled' : '' %>">
                        <a class="page-link" href="?page=<%= page+1 %>">
                            <i class="fas fa-angle-right"></i>
                        </a>
                    </li>

                    <li class="page-item <%= page===totalPages ? 'disabled' : '' %>">
                        <a class="page-link" href="?page=<%= totalPages %>">
                            <i class="fas fa-angle-double-right"></i>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

<div class="row justify-content-center ">

        <div class="col">
            <%- include('../parts/navbar') %>
        </div>

        <div class="col">
            <table class="table justify-content-center">
               <!--`sid`, `title`, `images`, `introduction`, `created_at`, `title_sid`-->
                <thead class="thead-dark">
                <tr>
                    <th scope="col"><i class="fas fa-trash-alt"></i></th>
                    <th scope="col"><i class="fas fa-edit"></i></th>
                    <th scope="col">#</th>
                    <th scope="col">文章標題</th>
                    <th scope="col">文章圖片</th>
                    <th scope="col">文章介紹</th>
                    <th scope="col">文章發佈日期</th>
                    <th scope="col">文章種類</th>
                </tr>
                </thead>
                <tbody>
                <% for(let i of rows){ %>
                <tr>
                     <!--`sid`, `title`, `images`, `introduction`, `created_at`, `title_sid`-->
                    <td><a href="#"><i class="fas fa-trash-alt" data-sid="<%= i.sid %>"></i></a></td>
                    <td>
                        <a href="/a_title_mainlist/edit/<%= i.sid %>">
                            <i class="fas fa-edit"></i>
                        </a>
                    </td>
                    <td><%= i.sid %></td>
                    <td><div class="wrap02"><%= i.title %></div></td>
                    <td>
                        <div class="wrap">
                            <img src="/img/<%= i.images %>" alt="" width="150px">
                        </div>
                    </td>
                    <td>
                        <div class="wrap03">
                            <%= i.introduction %>
                        </div>
                    </td>
                    <td><div class="wrap02"><%= i.created_at %></div></td>
                    <td><div class="wrap02"><%= i.title_sid %></div></td>

                </tr>
                <% } %>
                </tbody>
            </table>

        </div>
    </div>

     <div class="row justify-content-center">

        <nav aria-label="Page navigation example">
            <ul class="pagination">
                <li class="page-item <%= page===1 ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=1">
                        <i class="fas fa-angle-double-left"></i>
                    </a>
                </li>

                <li class="page-item <%= page===1 ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=<%= page-1 %>">
                        <i class="fas fa-angle-left"></i>
                    </a>
                </li>

                <% for(let i=beginPage; i<=endPage; i++){ %>
                <li class="page-item <%= i===page ? 'active' : '' %>">
                    <a class="page-link" href="?page=<%= i %>"><%= i %></a>
                </li>
                <% } %>

                <li class="page-item <%= page===totalPages ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=<%= page+1 %>">
                        <i class="fas fa-angle-right"></i>
                    </a>
                </li>

                <li class="page-item <%= page===totalPages ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=<%= totalPages %>">
                        <i class="fas fa-angle-double-right"></i>
                    </a>
                </li>
            </ul>
        </nav>

    </div>

</div>

<%- include('../parts/scripts') %>
<script>

    $('table tbody .fa-trash-alt').on('click', function(){
        const sid = $(this).attr('data-sid');
        // const sid = $(this).data('sid');

        fetch('/a_title_mainlist/del/'+sid, {
            method: 'DELETE',
        })
        .then(r=>r.json())
        .then(obj=>{
            console.log(obj);
            location.reload();
        })

    });

    /*
    document.querySelector('tbody').addEventListener('click', (event)=>{
        console.log(event.target.className);
        console.log(event.target.classList);
        if(event.target.classList.contains('fa-trash')){
            event.target.closest('tr').remove();
        }
    });
    */
</script>
<%- include('../parts/html-foot') %>