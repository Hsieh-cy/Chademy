<%- include('../parts/html-head') %>
<style>
    body {
        background-color: #EFF0F0;
    }



    table.table tr th {
        background-color: #5F6B6B !Important;

        color: white !Important;

    }

    .choose {
        color: #5F6B6B;
        cursor: pointer;
    }

    .fas {
        color: #5F6B6B;
    }

    .choose:hover {
        color: #C77334;
    }

    .redstars {
        color: red;
    }

    .pagination>li>a {
        background-color: white;
        color: darkgray;
    }

    .pagination>li>a:focus,
    .pagination>li>a:hover,
    .pagination>li>span:focus,
    .pagination>li>span:hover {
        color: #5a5a5a;
        background-color: #eee;
        border-color: #ddd;
    }

    .pagination>.active>a {
        color: white;
        background-color: #C77334 !Important;
        border: solid 1px #ddd !Important;
    }

    .pagination>.active>a:hover {
        background-color: #C77334 !Important;
        border: solid 1px #5A4181;
    }

    h3 {
        margin: auto;
        margin-top: 0px;
        margin-bottom: 20px;
    }

    .breadcrumb {
        background-color: #EFF0F0;
    }

    .breadcrumb .breadcrumb-item.active {
        color: #C77334;
    }

    .right {
        margin: 0 3px 10px;

    }

    table tr:hover {
        background-color: #e9e1dc;
    }

    table tbody .fa-trash {
        color: #5F6B6B;
        cursor: pointer;
    }

    i.fa-trash:hover {
        color: #C77334;
    }

    i.fa-edit:hover {
        color: #C77334;
    }

    .pagination>li>a {
        background-color: white;
        color: darkgray;
    }

    .pagination>li>a:focus,
    .pagination>li>a:hover,
    .pagination>li>span:focus,
    .pagination>li>span:hover {
        color: #5a5a5a;
        background-color: #eee;
        border-color: #ddd;
    }

    .pagination>.active>a {
        color: white;
        background-color: #C77334 !Important;
        border: solid 1px #ddd !Important;
    }

    .pagination>.active>a:hover {
        background-color: #C77334 !Important;
        border: solid 1px #5A4181;
    }

    .wrap {
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
        width: 150px;
    }

    .wrap img {
        width: 100%;
        height: 150px;
        object-fit: cover
    }
</style>
<%- include('../parts/navbar') %>



<div class="container">
    <div class="row justify-content-center">
        <h3>新創募資列表</h3>
    </div>




    <div class="row justify-content-a">
        <a href="/fund/list" class="btn btn-light choose"><i class="fas fa-list"></i></a>
        <a href="/fund/add " class="btn btn-light choose"><i class="fas fa-th"></i></a>
    </div>
    <div class="col">
        <nav aria-label="Page navigation example">
            <ul class="pagination">
                <li class="page-item <%= page===1 ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=1">
                        <i class="fas fa-angle-double-left"></i>
                    </a>
                </li>

                <li class="page-item <%= page===1 ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=<%= page-1 %>">
                        <i class="fas fa-angle-left"></i>
                    </a>
                </li>

                <% for(let i=beginPage; i<=endPage; i++){ %>
                <li class="page-item <%= i===page ? 'active' : '' %>">
                    <a class="page-link" href="?page=<%= i %>"><%= i %></a>
                </li>
                <% } %>

                <li class="page-item <%= page===totalPages ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=<%= page+1 %>">
                        <i class="fas fa-angle-right"></i>
                    </a>
                </li>

                <li class="page-item <%= page===totalPages ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=<%= totalPages %>">
                        <i class="fas fa-angle-double-right"></i>
                    </a>
                </li>
            </ul>
        </nav>
    </div>


        <table class="table">
            <thead class="thead-dark">
                <tr>

                    <th scope="col">刪除</th>
                    <!-- <th scope="col">#</th> -->
                    <th scope="col">募資編號</th>
                    <th scope="col">設計師編號</th>
                    <th scope="col">募資名稱</th>
                    <th scope="col">種類</th>
                    <th scope="col">圖片</th>
                    <th scope="col">介紹</th>
                    <th scope="col">最低價格</th>
                    <th scope="col">目標金額</th>
                    <th scope="col">開始時間</th>
                    <th scope="col">結束時間</th>
                    <th scope="col">實踐時間</th>
                    <th scope="col">編輯</th>
                </tr>
            </thead>
            <!-- `sid`, `e_designer_sid`, `e_proname`, `e_cate`, `e_pic`, `e_prointro`, `e_lowprice`, `e_goal`, `e_start_time`, `e_end_time`, `e_pro_url`, `e_realize_time`, `e_created_at`SELECT * FROM `e_fund_project`  -->
            <tbody>

                <% for(let i of rows){ %>
                <tr>
                    <td><i class="fas fa-trash my-trash-i" data-sid="<%= i.sid %>"></i>
                    </td>

                    <td><%= i.sid %></td>
                    <td><%= i.e_designer_sid %></td>
                    <td><%= i.e_proname %></td>
                    <td><%= i.e_cate %></td>
                    <td>
                        <div class="wrap">
                            <img src="/img/<%=i.e_pic %>" alt="" width="150px">
                        </div>
                    </td>
                    <td><%= i.e_prointro %></td>
                    <td><%= i.e_lowprice %></td>
                    <td><%= i.e_goal %></td>
                    <td><%= i.e_start_time %></td>
                    <td><%= i.e_end_time %></td>
                    <td><%= i.e_realize_time%></td>

                    <td>
                        <a href="/fund/edit/<%= i.sid %>">
                            <i class="fas fa-edit"></i>
                        </a>
                    </td>

                </tr>
                <% } %>
            </tbody>
        </table>
    </div>

<%- include('../parts/scripts') %>
<script>

    $('table tbody .fa-trash').on('click', function () {
        const sid = $(this).attr('data-sid');
        // const sid = $(this).data('sid');

        fetch('/fund/del/' + sid, {
            method: 'DELETE',
        })
            .then(r => r.json())
            .then(obj => {
                console.log(obj);
                location.reload();
            })

    });

</script>
<%- include('../parts/html-foot') %>